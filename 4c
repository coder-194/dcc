4.2

Great! Here's your **complete DevOps Guide** for **installing Jenkins**, **installing SonarQube**, **setting up integration**, and **building a pipeline** to run **SonarQube code analysis** using Jenkins on a **Windows system**, especially for Python or Maven projects.

---

# ğŸ› ï¸ **DevOps Program 4 â€“ Jenkins + SonarQube Integration (Complete Guide)**

---

## âœ… **1. Install Jenkins on Windows**

### ğŸ”½ Download & Install:

1. Download Jenkins `.msi`:
   ğŸ‘‰ [https://www.jenkins.io/download/](https://www.jenkins.io/download/)
2. Run `jenkins.msi`
3. Click **Next â†’ Next**
4. Select: **Run Service as LocalSystem**
5. Port: `8081` â†’ Test port â†’ **Next**
6. If **Java not detected**, download JDK 21+:

   * [Download JDK 21](https://www.oracle.com/java/technologies/downloads/#jdk21-windows)
   * Install using `.msi`
   * Take note of **installation path** (e.g., `C:\Program Files\Java\jdk-21`)
7. In Jenkins install wizard, select the JDK path
8. Click: **Install â†’ Finish**

---

### ğŸ” Unlock Jenkins:

1. Open: `http://localhost:8081`
2. Unlock with:

```bash
notepad.exe C:\ProgramData\Jenkins\.jenkins\secrets\initialAdminPassword
```

3. Paste password â†’ Click **Continue**
4. Choose: **Install Suggested Plugins**
5. Create admin user:

   * Username: `admin`
   * Password: `admin` *(for demo only)*
6. Use default URL â†’ Click: **Start using Jenkins**

---

## âœ… **2. Install & Configure SonarQube**

### ğŸ”½ Download & Start:

1. Download SonarQube:
   ğŸ‘‰ [https://www.sonarsource.com/products/sonarqube/downloads/](https://www.sonarsource.com/products/sonarqube/downloads/)
2. Extract ZIP â†’ Navigate to:

   ```
   sonarqube-<version>/bin/windows-x86-64/
   ```
3. Run: `StartSonar.bat` (Allow access)
4. Open: [http://localhost:9000](http://localhost:9000)
5. Login:

   * Username: `admin`
   * Password: `admin` â†’ Update password to `Admin@123.456`

---

### ğŸ”‘ Generate Token for Jenkins:

1. Go to: **My Account â†’ Security â†’ Generate Tokens**
2. Name: `jenkins` â†’ Set expiration: `Never`
3. Copy the token (e.g., `squ_abcdef...`)
   ğŸ’¡ Save this in Notepad â€” **one-time visibility only**

---

## âœ… **3. Jenkins: Install SonarQube Scanner & Setup**

### ğŸ“¦ Install Plugin:

* Jenkins â†’ **Manage Jenkins â†’ Plugins**
* Search: `SonarQube Scanner` â†’ Install + Restart

---

### ğŸ”§ Global Tool Configuration:

* **Manage Jenkins â†’ Global Tool Configuration**

  * Add **SonarQube Scanner**:

    * Name: `sonar`
    * Auto-install âœ…

---

### ğŸŒ Configure SonarQube Server:

* Go to: **Manage Jenkins â†’ Configure System**
* In **SonarQube Servers**:

  * Name: `sonar`
  * URL: `http://localhost:9000`
  * Add credentials:

    * Type: `Secret Text`
    * ID: `sonar`
    * Secret: *(Paste token from earlier)*

âœ… Check: **Environment variables box**
âœ… Select credential under â€œServer Authentication Tokenâ€

Click **Save**

---

## âœ… **4. Create and Run a Jenkins Pipeline (SonarQube Code Analysis)**

### ğŸ“ Create `helloworld.py`:

* Save this Python file at:

```bash
C:\Users\Admin\Desktop\helloworld.py
```

```python
def DoSomething():
    password = "123456"
    print("Hi")
    eval("print('Insecure')")
```

---

### ğŸ”§ Jenkins Pipeline Setup:

1. Jenkins â†’ **New Item â†’ Pipeline**

   * Name: `DO-P4`
   * Click OK

2. **Pipeline Script**:

```groovy
pipeline {
    agent any
    stages {
        stage('Prepare Workspace') {
            steps {
                // Copy Python code to workspace
                bat 'xcopy /s /e /y "C:\\Users\\Admin\\Desktop\\helloworld.py" .'
            }
        }

        stage('Code Analysis') {
            environment {
                scannerHome = tool 'sonar' // The name you gave in Global Tool Configuration
            }
            steps {
                script {
                    withSonarQubeEnv('sonar') {
                        bat """
                            ${scannerHome}\\bin\\sonar-scanner.bat ^
                            -Dsonar.projectKey=hellopy ^
                            -Dsonar.projectName=HelloWorldPython ^
                            -Dsonar.projectVersion=1.0 ^
                            -Dsonar.sources=.
                        """
                    }
                }
            }
        }
    }
}
```

3. Click **Save**
4. Click **Build Now**

---

### ğŸ“Š View SonarQube Analysis:

1. Go to: [http://localhost:9000](http://localhost:9000)
2. Project: `HelloWorldPython`
3. See:

   * Code quality issues
   * Vulnerabilities (e.g., `eval`, hardcoded password)
   * Code smells, duplications

---

## âœ… **Alternative: Java/Maven Jenkinsfile**

If your project is Maven-based, use this Jenkinsfile instead:

```groovy
pipeline {
    agent any
    tools {
        maven 'Maven_3'
    }
    environment {
        SONARQUBE_SERVER = 'sonar'
        SONAR_TOKEN = credentials('sonar')
    }
    stages {
        stage('Checkout') {
            steps {
                git branch: 'main', url: 'https://github.com/your-repo.git'
            }
        }
        stage('Build') {
            steps {
                sh 'mvn clean package'
            }
        }
        stage('Unit Test') {
            steps {
                sh 'mvn test'
            }
        }
        stage('SonarQube Analysis') {
            steps {
                withSonarQubeEnv(SONARQUBE_SERVER) {
                    sh """
                    mvn sonar:sonar \
                        -Dsonar.projectKey=my-app \
                        -Dsonar.host.url=http://localhost:9000 \
                        -Dsonar.login=${SONAR_TOKEN}
                    """
                }
            }
        }
        stage('Quality Gate') {
            steps {
                timeout(time: 1, unit: 'MINUTES') {
                    waitForQualityGate abortPipeline: true
                }
            }
        }
        stage('Deploy') {
            steps {
                sh 'mvn deploy'
            }
        }
    }
}
```

---

## ğŸ¯ Final Output

| Step                     | Outcome                             |
| ------------------------ | ----------------------------------- |
| Jenkins Installed        | âœ… Running on `localhost:8081`       |
| SonarQube Installed      | âœ… Running on `localhost:9000`       |
| Token Generated          | âœ… Added to Jenkins as secret        |
| Pipeline Created         | âœ… Scans Python or Maven code        |
| Code Analyzed            | âœ… SonarQube reports visible         |
| Security Issues Detected | âœ… e.g., `eval`, hardcoded passwords |
| Quality Gate Applied     | âœ… Pipeline fails if gate not met    |

---

Would you like a **downloadable PDF** version of this guide or a **Docker Compose setup** for Jenkins + SonarQube?
